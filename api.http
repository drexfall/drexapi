# Variables
@baseUrl = http://127.0.0.1:8000
@json = application/json
@userEmail = user{{$timestamp}}@example.com
@userPassword = Passw0rd!

### Create user
POST {{baseUrl}}/api/v1/users
Content-Type: {{json}}

{
  "email": "{{userEmail}}",
  "password": "{{userPassword}}"
}

> {%
  try {
    const body = JSON.parse(response.body);
    if (body && body.id) {
      client.global.set("userId", body.id);
      client.log(`Stored userId=${body.id}`);
    }
  } catch (e) {
    // ignore if not JSON
  }
%}

### List users
GET {{baseUrl}}/api/v1/users?skip=0&limit=10
Accept: {{json}}

### Get user by id
@userId = {{userId}}
GET {{baseUrl}}/api/v1/users/{{userId}}
Accept: {{json}}

### Open interactive docs (Swagger UI)
GET {{baseUrl}}/docs

### Utils: Parse PDF (stub returns 501 until implemented)
POST {{baseUrl}}/api/v1/utils/parse-pdf
Content-Type: multipart/form-data; boundary=MyBoundary

--MyBoundary
Content-Disposition: form-data; name="file"; filename="sample.pdf"
Content-Type: application/pdf

< ./path/to/sample.pdf
--MyBoundary
Content-Disposition: form-data; name="pages"

1-3
--MyBoundary
Content-Disposition: form-data; name="include_metadata"

true
--MyBoundary--

### Utils: Convert file (stub returns 501 until implemented)
POST {{baseUrl}}/api/v1/utils/convert
Content-Type: multipart/form-data; boundary=MyBoundary

--MyBoundary
Content-Disposition: form-data; name="file"; filename="sample.txt"
Content-Type: text/plain

< ./path/to/sample.txt
--MyBoundary
Content-Disposition: form-data; name="to_format"

pdf
--MyBoundary
Content-Disposition: form-data; name="from_format"

txt
--MyBoundary--
